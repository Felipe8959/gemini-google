def obter_historico_distribuicao():
    global df_base_cruzamento_enriq
    '''Função que consulta os analistas responsáveis por cada tema:'''
    if os.path.isfile("BASE_GERAL_DISTRIBUICAO.xlsx"):
        df_historico_demandas = pd.read_excel(
            "BASE_GERAL_DISTRIBUICAO.xlsx", engine="openpyxl", dtype=object
        )
        df_historico_demandas = df_historico_demandas[['PROTOCOLO', 'ANALISTAS']]

        # Remover 'NÃO DISTRIBUIR' e 'QUALIDADE' da coluna 'ANALISTAS'
        df_historico_demandas['ANALISTAS'] = df_historico_demandas['ANALISTAS'].replace(
            ['NÃO DISTRIBUIR', 'QUALIDADE'], "")

        df_base_cruzamento_enriq = pd.merge(
            df_relatorio_operacional, df_historico_demandas, on="PROTOCOLO", how="left"
        )
    else:
        df_base_cruzamento_enriq = df_relatorio_operacional

    df_base_cruzamento_enriq = df_base_cruzamento_enriq.drop_duplicates(subset="PROTOCOLO")
