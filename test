Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)
    Dim olMail As Outlook.MailItem
    Dim Prompt As String
    Dim AnexoFaltando As Boolean
    
    If TypeName(Item) = "MailItem" Then
        Set olMail = Item
        AnexoFaltando = (olMail.Attachments.Count = 0) And (InStr(olMail.Body, "anexo") > 0 Or InStr(olMail.Body, "anexado") > 0)
        
        If AnexoFaltando Then
            Prompt = "Você mencionou um anexo, mas não há nenhum arquivo anexado. Deseja enviar o e-mail mesmo assim?"
            If MsgBox(Prompt, vbYesNo + vbQuestion + vbMsgBoxSetForeground, "Anexo Faltando") = vbNo Then
                Cancel = True
            End If
        End If
    End If
End Sub
