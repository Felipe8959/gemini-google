dict_status_analista = df_distribuicao.groupby('STATUS_VENCIMENTO')['ANALISTA'].apply(list).to_dict()
dict_cpf_analista = {}
dict_analista_distribuicoes = {}

def distribuir_analistas(row):
    status = row['STATUS_VENCIMENTO']
    cpf_cnpj = row['CPF/CNPJ']
    
    # Se CPF já foi atribuído a um analista, retorne ele
    if cpf_cnpj in dict_cpf_analista:
        return dict_cpf_analista[cpf_cnpj]
    
    # Se há analistas disponíveis para o status
    if status in dict_status_analista:
        # Distribui igualmente os analistas
        analistas = dict_status_analista[status]
        for analista in analistas:
            if analista not in dict_analista_distribuicoes:
                dict_analista_distribuicoes[analista] = 0
            if dict_analista_distribuicoes[analista] < 18:
                dict_analista_distribuicoes[analista] += 1
                dict_cpf_analista[cpf_cnpj] = analista
                return analista
    
    # Se nenhum analista estiver disponível ou se excedeu o limite de distribuições
    return None
