# Dicionários globais para armazenar os dados dos analistas
dict_cpf_analista = {}
dict_status_analista = {}
analistas_protocolos = {}  # Armazena a contagem de protocolos por analista

def distribuir_analistas(row):
    status = row['STATUS_VENCIMENTO']
    cpf_cnpj = row['CPF/CNPJ']
    revisao = row['REVISÃO']
    prioridade = row['PRIORIDADE']

    # Inicializa a contagem de protocolos por analista se ainda não estiver no dicionário
    for analista in dict_status_analista.get(status, []):
        if analista not in analistas_protocolos:
            analistas_protocolos[analista] = 0

    # Se o CPF já foi atribuído a um analista, retorne ele
    if cpf_cnpj in dict_cpf_analista:
        return dict_cpf_analista[cpf_cnpj]

    # Função auxiliar para encontrar um analista disponível com menos de 18 protocolos
    def encontrar_analista():
        for analista in dict_status_analista.get(status, []):
            if analistas_protocolos[analista] < 18:
                return analista
        return None

    # Distribui igualmente para analistas se a revisão for "Sim"
    if revisao == "Sim" and status in dict_status_analista:
        analista = encontrar_analista()
        if analista:
            dict_cpf_analista[cpf_cnpj] = analista
            analistas_protocolos[analista] += 1
            return analista
        else:
            return None  # Não há analista disponível com menos de 18 protocolos

    # Completar com menores prioridades se o número de protocolos for menor que 18
    analista = encontrar_analista()
    if analista:
        dict_cpf_analista[cpf_cnpj] = analista
        analistas_protocolos[analista] += 1
        return analista

    # Se não há analista disponível com menos de 18 protocolos, retorna None
    return None

# Exemplo de uso:
# row = {'STATUS_VENCIMENTO': '...', 'CPF/CNPJ': '...', 'REVISÃO': 'Sim', 'PRIORIDADE': '...'}
# analista = distribuir_analistas(row)

# Exemplo de inicialização de dados
dict_status_analista = {
    'STATUS_1': ['HIGOR', 'PEDRO', 'JOSE', 'RAUL'],
    # Adicione outros status e seus analistas correspondentes conforme necessário
}

# Teste
rows = [
    {'STATUS_VENCIMENTO': 'STATUS_1', 'CPF/CNPJ': '111', 'REVISÃO': 'Sim', 'PRIORIDADE': 1},
    # Adicione outras linhas de teste conforme necessário
]

for row in rows:
    analista = distribuir_analistas(row)
    print(f"Protocolo {row['CPF/CNPJ']} atribuído a: {analista}")
