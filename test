from selenium import webdriver
from selenium.webdriver.edge.options import Options
import os

# Configurar as opções do Edge
edge_options = Options()

# Configurações para imprimir diretamente em PDF
edge_options.add_experimental_option("prefs", {
    "printing.print_preview_sticky_settings.appState": '{"recentDestinations":[{"id":"Save as PDF","origin":"local","account":"account"}],"selectedDestinationId":"Save as PDF","version":2}',
    "savefile.default_directory": os.getcwd(),  # Diretório de salvamento
    "savefile.overwrite_existing_file": True,
    "printing.default_destination_selection_rules": {
        "kind": "local",
        "namePattern": "Save as PDF"
    }
})
edge_options.add_argument("--kiosk-printing")  # Imprimir automaticamente

# Inicializa o driver com as opções
driver = webdriver.Edge(options=edge_options)

# Acessa a página e clica no botão de imprimir
driver.get('URL_DA_SUA_PAGINA')
botao = driver.find_element(By.ID, 'ID_DO_BOTAO')
botao.click()

# A impressão deve ser salva automaticamente como PDF
