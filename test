import pyodbc
import pandas as pd

def extrair_excel():
    try:
        # Conecte-se ao banco de dados Access
        conn_str = (
            r"DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};"
            r"DBQ=d4966s003\d4966_1\Secoes\S010\COMUM_S010\AUTOMATIZACOES\RA E CG\REGISTRO_CONSUMIDOR.GOV\Base_Registros_CG.accdb;"
        )
        cnxn = pyodbc.connect(conn_str)
        
        query_analistas = (
            "SELECT * FROM Registro WHERE ANALISTA_REGISTRO = '{nome_analista}' "
            "OR ANALISTA_RESPOSTA = '{nome_analista}'"
        )
        analistas = pd.read_sql(query_analistas, cnxn)
        
        caminho = f"C:/Users/{usuario_estacao}/Desktop/extraidos.xlsx"
        analistas.to_excel(caminho, index=False)
        
    except pyodbc.Error as e:
        print(f"Erro ao conectar ao banco de dados: {e}")
    except pd.io.sql.DatabaseError as e:
        print(f"Erro ao executar a consulta SQL: {e}")
    except FileNotFoundError as e:
        print(f"Caminho do arquivo não encontrado: {e}")
    except PermissionError as e:
        print(f"Permissão negada ao salvar o arquivo: {e}")
    except Exception as e:
        print(f"Ocorreu um erro inesperado: {e}")
    finally:
        try:
            cnxn.close()
        except:
            pass

def visualizar_tudo():
    # Implementação da função visualizer_tudo
    pass
