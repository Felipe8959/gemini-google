import pandas as pd
from openpyxl import load_workbook
from openpyxl.styles import PatternFill
from datetime import datetime

# Exemplo de DataFrame
data = {'PRAZO': ['2024-07-01', '2024-06-25', '2024-08-15']}
df = pd.DataFrame(data)
df['PRAZO'] = pd.to_datetime(df['PRAZO'])

# Salva o DataFrame em um arquivo Excel sem formatação
file_name = 'dataframe.xlsx'
df.to_excel(file_name, index=False)

# Carrega o arquivo Excel para aplicar formatação condicional
wb = load_workbook(file_name)
ws = wb.active

# Define a cor de preenchimento (amarelo)
yellow_fill = PatternFill(start_color="FFFF00", end_color="FFFF00", fill_type="solid")

# Obtenha a data de hoje
today = datetime.today()

# Itera sobre as células na coluna 'PRAZO' (assumindo que está na coluna B)
for row in range(2, ws.max_row + 1):  # Começa na linha 2 para pular o cabeçalho
    cell = ws[f'B{row}']
    cell_date = pd.to_datetime(cell.value)
    if cell_date > today:
        cell.fill = yellow_fill

# Salva as mudanças no arquivo Excel
wb.save(file_name)
