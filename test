import pandas as pd
import xlsxwriter
from datetime import datetime

# Suponha que você tenha um DataFrame 'df' com uma coluna 'PRAZO'
data = {'PRAZO': ['2024-07-01', '2024-06-20', '2024-06-30']}
df = pd.DataFrame(data)

# Convertendo a coluna 'PRAZO' para datetime
df['PRAZO'] = pd.to_datetime(df['PRAZO'])

# Criando um arquivo Excel
filename = 'prazo.xlsx'
writer = pd.ExcelWriter(filename, engine='xlsxwriter')
df.to_excel(writer, index=False, sheet_name='Sheet1')

# Obtendo o workbook e o worksheet
workbook  = writer.book
worksheet = writer.sheets['Sheet1']

# Formatando as datas
date_format = workbook.add_format({'num_format': 'yyyy-mm-dd'})

# Aplicando a formatação condicional
yellow_format = workbook.add_format({'bg_color': 'yellow'})

# Obtendo a data atual
current_date = datetime.now().strftime('%Y-%m-%d')

# Adicionando a formatação condicional
worksheet.conditional_format('A2:A{}'.format(len(df)+1), 
                             {'type': 'formula',
                              'criteria': '=$A2>TODAY()',
                              'format': yellow_format})

# Salvando o arquivo
writer.save()
