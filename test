from transformers import BertTokenizerFast, EncoderDecoderModel
import torch

# Definindo o dispositivo (GPU se disponível)
device = 'cuda' if torch.cuda.is_available() else 'cpu'

# Carregando o modelo e o tokenizer
modelo = 'mrm8488/bert2bert_shared-spanish-finetuned-summarization'
tokenizer = BertTokenizerFast.from_pretrained(modelo)
model = EncoderDecoderModel.from_pretrained(modelo).to(device)

# Função para gerar sumarização
def gerar_resumo(texto):
    inputs = tokenizer([texto], padding="max_length", truncation=True, max_length=512, return_tensors="pt")
    input_ids = inputs.input_ids.to(device)
    attention_mask = inputs.attention_mask.to(device)
    output = model.generate(input_ids, attention_mask=attention_mask)
    return tokenizer.decode(output[0], skip_special_tokens=True)

# Exemplo de texto em português (pode precisar de ajustes)
texto = """
Python é uma linguagem de programação de alto nível, interpretada e de propósito geral. Sua filosofia de design enfatiza a legibilidade do código e usa indentação significativa. Python é dinâmico e coletado por lixo, suportando múltiplos paradigmas de programação. Possui uma grande biblioteca padrão, que inclui diversos módulos e pacotes para desenvolvimento rápido e eficiente.
"""

# Gerando o resumo
resumo = gerar_resumo(texto)
print("Resumo gerado:")
print(resumo)
