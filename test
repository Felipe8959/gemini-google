import os
import win32com.client

# Conectando ao Outlook
outlook = win32com.client.Dispatch("Outlook.Application").GetNamespace("MAPI")

# Selecionando a caixa de entrada mapeada
# Altere o índice conforme a posição da caixa de entrada mapeada (0 é a principal)
caixa_de_entrada = outlook.Folders['Nome da Caixa Mapeada'].Folders['Caixa de Entrada']

# Defina o assunto específico que você está procurando
assunto_especifico = "Assunto do Email"

# Pasta onde o anexo será salvo
pasta_destino = "C:/caminho/para/salvar/anexo"

# Iterando pelos emails
for email in caixa_de_entrada.Items:
    if assunto_especifico in email.Subject:
        for anexo in email.Attachments:
            # Salvando o anexo
            caminho_arquivo = os.path.join(pasta_destino, anexo.FileName)
            anexo.SaveAsFile(caminho_arquivo)
            print(f"Anexo {anexo.FileName} salvo em {caminho_arquivo}")

        # Sai do loop após encontrar o e-mail
        break
