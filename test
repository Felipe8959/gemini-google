import pandas as pd
import re

# Função para validar CPF
def validar_cpf(cpf):
    cpf = re.sub(r'\D', '', cpf)  # Remove caracteres não numéricos
    if len(cpf) != 11 or cpf in [str(i) * 11 for i in range(10)]:
        return False
    # Validação do dígito verificador
    for i in range(9, 11):
        soma = sum(int(cpf[num]) * ((i + 1) - num) for num in range(i))
        digito = (soma * 10) % 11
        if digito == 10:
            digito = 0
        if digito != int(cpf[i]):
            return False
    return True

# Função para validar CNPJ
def validar_cnpj(cnpj):
    cnpj = re.sub(r'\D', '', cnpj)  # Remove caracteres não numéricos
    if len(cnpj) != 14:
        return False
    pesos_1 = [5, 4, 3, 2, 9, 8, 7, 6, 5, 4, 3, 2]
    pesos_2 = [6] + pesos_1
    # Validação dos dígitos verificadores
    for i in range(12, 14):
        soma = sum(int(cnpj[num]) * pesos_1[num] if i == 12 else pesos_2[num] for num in range(i))
        digito = soma % 11
        if digito < 2:
            digito = 0
        else:
            digito = 11 - digito
        if digito != int(cnpj[i]):
            return False
    return True

# Função para identificar o tipo de documento
def identificar_documento(doc):
    doc = str(doc)
    if validar_cpf(doc):
        return "CPF"
    elif validar_cnpj(doc):
        return "CNPJ"
    else:
        return "Nenhum"

# Exemplo de DataFrame
data = {'documentos': ['123.456.789-09', '12.345.678/0001-95', '11111111111', '12345678901234']}
df = pd.DataFrame(data)

# Aplicando a função
df['tipo_documento'] = df['documentos'].apply(identificar_documento)

# Exibindo o resultado
print(df)
